name: Update Roster
on:
  push:
    paths:
      - members.txt
      - scripts/build-roster.py
  schedule:
    - cron: '0 */6 * * *'
  workflow_dispatch:

concurrency:
  group: update-roster
  cancel-in-progress: true

permissions:
  contents: write

jobs:
  update-roster:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Build roster page
        run: python3 scripts/build-roster.py
      - name: Commit if changed
        run: |
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'
          git add roster.html
          git diff --cached --quiet || (git commit -m "Update roster" && git push)
